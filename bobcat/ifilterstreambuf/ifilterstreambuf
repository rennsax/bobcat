#ifndef INCLUDED_BOBCAT_IFILTERSTREAMBUF_
#define INCLUDED_BOBCAT_IFILTERSTREAMBUF_

#include <bobcat/eoibuf>

namespace FBB
{

class IFilterStreambuf: public EoiBuf
{
    size_t d_maxSize;

    char const *d_srcBegin = 0;
    char const *d_srcEnd = 0;

    public:
        ~IFilterStreambuf() override;

    protected:
        IFilterStreambuf(size_t bufSize = 1000);
        void setBuffer();                                   // .f

    private:
        virtual bool filter(char const **srcBegin, char const **srcEnd) = 0;

        int underflow()             override;
        std::streamsize showmanyc() override;
        int pbackfail(int ch)       override;
};

#include "setbuffer.f"

} // FBB        
#endif


