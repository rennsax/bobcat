#ifndef INCLUDED_BOBCAT_OHEXSTREAMBUF_
#define INCLUDED_BOBCAT_OHEXSTREAMBUF_

#include <iosfwd>
#include <string>

#include <bobcat/ofilterstreambuf>

namespace FBB
{

class OHexStreambuf: public OFilterStreambuf
{
    std::ios::fmtflags d_current;
    char d_padding;
    size_t d_width;
    size_t d_count;

    std::string d_separator;

    void (OHexStreambuf::*d_separated)(int ch); 
    void (OHexStreambuf::*d_widthHandler)(); 

    public:
        OHexStreambuf(std::ostream &out, size_t width = 0, 
                                         std::string const &separator = "");
        ~OHexStreambuf() override;
        size_t size() const;                                            // .f

        void separator(bool reset = true);                          // 1
        void separator(std::string const &sep, bool reset = true);  // 2
        
        static std::string text2bin(std::string const &in); // length and 
                                                            // contents not
                                                            // checked
    private:
        int overflow(int ch) override;
        int sync() override;

        void separated(int ch);
        void plain(int ch);

        void widthHandler();
        void noWidth();

        void clear(bool reset);
};

#include "size.f"

} // FBB        
#endif





